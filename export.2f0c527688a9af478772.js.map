{"version":3,"file":"export.2f0c527688a9af478772.js","mappings":"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","sources":["webpack://excel-csv-import/./components/Export.tsx","webpack://excel-csv-import/./node_modules/file-saver/dist/FileSaver.min.js"],"sourcesContent":["import * as React from 'react';\nimport {useState} from 'react';\nimport {DelimiterInput} from './DelimiterInput';\nimport {NewlineDropdown} from './NewlineDropdown';\nimport {\n\tDropdown,\n\tIDropdownOption,\n\tPrimaryButton,\n\tResponsiveMode,\n\tTextField,\n\tTooltipHost,\n} from '@fluentui/react';\nimport {NewlineSequence} from '../parser';\nimport * as FileSaver from 'file-saver';\nimport {EncodingDropdown} from './EncodingDropdown';\nimport {ProgressBar} from './ProgressBar';\nimport * as style from './style.css';\nimport {BottomBar} from './BottomBar';\nimport {ParserOutputBox} from './ParserOutputBox';\nimport {Page} from './Page';\nimport {namespacedUseLocalStorage} from '../useLocalStorage';\nimport {AppState} from '../state';\nimport {useDispatch, useSelector} from 'react-redux'\nimport {abort, Dispatch, exportCSV} from '../action';\n\nexport const enum ExportType {file, text}\n\nconst useLocalStorage = namespacedUseLocalStorage('export');\n\nexport default function Export(): React.ReactElement {\n\tconst initialized = useSelector(state => state.initialized) as AppState['initialized'];\n\tconst platform = useSelector(state => state.platform) as AppState['platform'];\n\tconst progress = useSelector(state => state.progress) as AppState['progress'];\n\tconst output = useSelector(state => state.output) as AppState['output'];\n\tconst dispatch = useDispatch() as Dispatch;\n\n\tconst [exportType, setExportType] = useLocalStorage('exportType', ExportType.text);\n\tconst [delimiter, setDelimiter] = useLocalStorage('delimiter', '\\u002c');\n\tconst [newline, setNewline] = useLocalStorage('newline', NewlineSequence.CRLF);\n\tconst [encoding, setEncoding] = useLocalStorage('encoding', 'UTF-8');\n\tconst [outputText, setOutputText] = useState('');\n\n\tconst exportTypeOptions: IDropdownOption[] = [{\n\t\tkey: ExportType.text,\n\t\ttext: 'Textbox',\n\t}];\n\t// Export file feature only works on Excel Online\n\t// https://github.com/Emurasoft/excel-csv-import/issues/39\n\t// eslint-disable-next-line no-undef\n\tif (platform === Office.PlatformType.OfficeOnline) {\n\t\texportTypeOptions.push({\n\t\t\tkey: ExportType.file,\n\t\t\ttext: 'File',\n\t\t});\n\t}\n\n\tconst buttonOnClick = async () => {\n\t\tsetOutputText('');\n\n\t\tconst exportTypeCopy = exportType; // Copy current options before async task\n\t\tconst encodingCopy = encoding;\n\t\tconst csvStringAndName = await dispatch(exportCSV({delimiter, newline}));\n\t\tif (csvStringAndName === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (exportTypeCopy) {\n\t\tcase ExportType.file: {\n\t\t\tconst options = {type: 'text/csv;charset=' + encodingCopy};\n\t\t\tconst blob = new Blob([csvStringAndName.string], options);\n\t\t\tFileSaver.saveAs(blob, csvStringAndName.name + '.csv');\n\t\t\treturn;\n\t\t}\n\t\tcase ExportType.text: {\n\t\t\tsetOutputText(csvStringAndName.string)\n\t\t\treturn;\n\t\t}\n\t\t}\n\t}\n\n\treturn (\n\t\t<Page\n\t\t\ttext={'Export CSV'}\n\t\t\thelpLink={\n\t\t\t\t'https://github.com/Emurasoft/excel-csv-import-help/blob/master/en.md#export-csv'\n\t\t\t}\n\t\t\t// eslint-disable-next-line no-undef\n\t\t\tmac={platform === Office.PlatformType.Mac}\n\t\t>\n\t\t\t<Dropdown\n\t\t\t\tlabel={'Export type'}\n\t\t\t\toptions={exportTypeOptions}\n\t\t\t\tresponsiveMode={ResponsiveMode.large}\n\t\t\t\tselectedKey={exportType}\n\t\t\t\tonChange={(_, option) => setExportType(option.key as ExportType)}\n\t\t\t\tid={'exportTypeDropdown'}\n\t\t\t/>\n\t\t\t<br />\n\t\t\t{\n\t\t\t\texportType === ExportType.file\n\t\t\t\t\t? <EncodingDropdown\n\t\t\t\t\t\tvalue={encoding}\n\t\t\t\t\t\tonChange={setEncoding}\n\t\t\t\t\t\tshowAutoDetect={false}\n\t\t\t\t\t/>\n\t\t\t\t\t: null\n\t\t\t}\n\t\t\t<DelimiterInput\n\t\t\t\tvalue={delimiter}\n\t\t\t\tonChange={setDelimiter}\n\t\t\t\tshowLengthError={false}\n\t\t\t/>\n\t\t\t<br />\n\t\t\t<NewlineDropdown\n\t\t\t\tvalue={newline}\n\t\t\t\tonChange={setNewline}\n\t\t\t\tshowAutoDetect={false}\n\t\t\t/>\n\t\t\t<br />\n\t\t\t<TooltipHost\n\t\t\t\tstyles={{root: {display: 'inline-block'}}}\n\t\t\t\tcontent={\n\t\t\t\t\tinitialized\n\t\t\t\t\t\t? ''\n\t\t\t\t\t\t: 'Excel API is not initialized'\n\t\t\t\t}\n\t\t\t>\n\t\t\t\t<PrimaryButton\n\t\t\t\t\tonClick={buttonOnClick}\n\t\t\t\t\tdisabled={!initialized}\n\t\t\t\t\ttext={'Export to CSV'}\n\t\t\t\t/>\n\t\t\t</TooltipHost>\n\t\t\t<br />\n\t\t\t<ProgressBar\n\t\t\t\tonClick={() => dispatch(abort())}\n\t\t\t\tprogress={progress}\n\t\t\t/>\n\t\t\t{\n\t\t\t\texportType == ExportType.text\n\t\t\t\t\t? <TextField\n\t\t\t\t\t\tvalue={outputText} readOnly\n\t\t\t\t\t\tlabel={'Export result'}\n\t\t\t\t\t\tclassName={style.monospace}\n\t\t\t\t\t\trows={15} multiline\n\t\t\t\t\t\tspellCheck={false}\n\t\t\t\t\t\twrap='off'\n\t\t\t\t\t/>\n\t\t\t\t\t: null\n\t\t\t}\n\t\t\t<ParserOutputBox output={output} />\n\t\t\t<BottomBar />\n\t\t</Page>\n\t);\n}","(function(a,b){if(\"function\"==typeof define&&define.amd)define([],b);else if(\"undefined\"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){\"use strict\";function b(a,b){return\"undefined\"==typeof b?b={autoBom:!1}:\"object\"!=typeof b&&(console.warn(\"Deprecated: Expected third argument to be a object\"),b={autoBom:!b}),b.autoBom&&/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(a.type)?new Blob([\"\\uFEFF\",a],{type:a.type}):a}function c(b,c,d){var e=new XMLHttpRequest;e.open(\"GET\",b),e.responseType=\"blob\",e.onload=function(){a(e.response,c,d)},e.onerror=function(){console.error(\"could not download file\")},e.send()}function d(a){var b=new XMLHttpRequest;b.open(\"HEAD\",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent(\"click\"))}catch(c){var b=document.createEvent(\"MouseEvents\");b.initMouseEvent(\"click\",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f=\"object\"==typeof window&&window.window===window?window:\"object\"==typeof self&&self.self===self?self:\"object\"==typeof global&&global.global===global?global:void 0,a=f.saveAs||(\"object\"!=typeof window||window!==f?function(){}:\"download\"in HTMLAnchorElement.prototype?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement(\"a\");g=g||b.name||\"download\",j.download=g,j.rel=\"noopener\",\"string\"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target=\"_blank\")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:\"msSaveOrOpenBlob\"in navigator?function(f,g,h){if(g=g||f.name||\"download\",\"string\"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement(\"a\");i.href=f,i.target=\"_blank\",setTimeout(function(){e(i)})}}:function(a,b,d,e){if(e=e||open(\"\",\"_blank\"),e&&(e.document.title=e.document.body.innerText=\"downloading...\"),\"string\"==typeof a)return c(a,b,d);var g=\"application/octet-stream\"===a.type,h=/constructor/i.test(f.HTMLElement)||f.safari,i=/CriOS\\/[\\d]+/.test(navigator.userAgent);if((i||g&&h)&&\"object\"==typeof FileReader){var j=new FileReader;j.onloadend=function(){var a=j.result;a=i?a:a.replace(/^data:[^;]*;/,\"data:attachment/file;\"),e?e.location.href=a:location=a,e=null},j.readAsDataURL(a)}else{var k=f.URL||f.webkitURL,l=k.createObjectURL(a);e?e.location=l:location.href=l,e=null,setTimeout(function(){k.revokeObjectURL(l)},4E4)}});f.saveAs=a.saveAs=a,\"undefined\"!=typeof module&&(module.exports=a)});\n\n//# sourceMappingURL=FileSaver.min.js.map"],"names":["useLocalStorage","Export","initialized","state","platform","progress","output","dispatch","exportType","setExportType","delimiter","setDelimiter","newline","setNewline","encoding","setEncoding","useState","outputText","setOutputText","exportTypeOptions","key","text","Office","PlatformType","OfficeOnline","push","buttonOnClick","exportTypeCopy","encodingCopy","csvStringAndName","options","type","blob","Blob","string","name","helpLink","mac","Mac","label","responsiveMode","selectedKey","onChange","_","option","id","value","showAutoDetect","showLengthError","styles","root","display","content","onClick","disabled","readOnly","className","rows","multiline","spellCheck","wrap","c","b","d","e","XMLHttpRequest","open","responseType","onload","a","response","onerror","console","error","send","status","dispatchEvent","MouseEvent","document","createEvent","initMouseEvent","window","f","self","g","global","saveAs","HTMLAnchorElement","prototype","h","i","URL","webkitURL","j","createElement","download","rel","href","origin","location","target","createObjectURL","setTimeout","revokeObjectURL","navigator","msSaveOrOpenBlob","autoBom","warn","test","title","body","innerText","HTMLElement","safari","userAgent","FileReader","onloadend","result","replace","readAsDataURL","k","l","module","exports"],"sourceRoot":""}