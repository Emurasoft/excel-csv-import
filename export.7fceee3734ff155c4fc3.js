(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{573:function(e,t,n){(function(n){var r,o,a;o=[],void 0===(a="function"==typeof(r=function(){"use strict";function t(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){i(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,i=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype?function(e,n,i){var c=a.URL||a.webkitURL,l=document.createElement("a");n=n||e.name||"download",l.download=n,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?o(l):r(l.href)?t(e,n,i):o(l,l.target="_blank")):(l.href=c.createObjectURL(e),setTimeout((function(){c.revokeObjectURL(l.href)}),4e4),setTimeout((function(){o(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,a){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,a),n);else if(r(e))t(e,n,a);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){o(i)}))}}:function(e,n,r,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,r);var i="application/octet-stream"===e.type,c=/constructor/i.test(a.HTMLElement)||a.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||i&&c)&&"object"==typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},u.readAsDataURL(e)}else{var s=a.URL||a.webkitURL,f=s.createObjectURL(e);o?o.location=f:location.href=f,o=null,setTimeout((function(){s.revokeObjectURL(f)}),4e4)}});a.saveAs=i.saveAs=i,e.exports=i})?r.apply(t,o):r)||(e.exports=a)}).call(this,n(131))},602:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return k})),n.d(t,"ExportComponent",(function(){return j}));n(94),n(95),n(96),n(177),n(69),n(178),n(129),n(68),n(100),n(97),n(98),n(80),n(99);var r=n(184),o=n(1),a=n(536),i=n(537),c=n(604),l=n(543),u=n(606),s=n(611),f=n(607),p=n(573),d=n(544),m=n(538),v=n(128),b=n(539),y=n(540),w=n(545),h=n(541);function E(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(){return o.createElement(j,{store:Object(o.useContext)(r.a)})}var O=Object(h.a)("export");function j(e){var t=e.store,n=g(O("exportType",1),2),r=n[0],h=n[1],x=g(O("delimiter",","),2),k=x[0],j=x[1],A=g(O("newline","\r\n"),2),S=A[0],T=A[1],L=g(O("encoding","UTF-8"),2),R=L[0],C=L[1],M=g(Object(o.useState)(""),2),U=M[0],B=M[1],D=[{key:1,text:"Textbox"}];t.state.platform===Office.PlatformType.OfficeOnline&&D.push({key:0,text:"File"});var F=function(){var e,n=(e=regeneratorRuntime.mark((function e(){var n,o,a,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(""),n=r,o=R,e.next=5,t.csvStringAndName({delimiter:k,newline:S});case 5:if(null!==(a=e.sent)){e.next=8;break}return e.abrupt("return");case 8:e.t0=n,e.next=0===e.t0?11:1===e.t0?15:17;break;case 11:return i={type:"text/csv;charset="+o},c=new Blob([a.string],i),p.saveAs(c,a.name+".csv"),e.abrupt("return");case 15:return B(a.string),e.abrupt("return");case 17:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){E(a,r,o,i,c,"next",e)}function c(e){E(a,r,o,i,c,"throw",e)}i(void 0)}))});return function(){return n.apply(this,arguments)}}();return o.createElement(o.Fragment,null,o.createElement("div",{className:v.pageMargin},o.createElement(w.a,{text:"Export CSV",helpLink:"https://github.com/Emurasoft/excel-csv-import-help/blob/master/en.md#export-csv",mac:t.state.platform===Office.PlatformType.Mac}),o.createElement(c.a,{label:"Export type",options:D,responsiveMode:l.a.large,selectedKey:r,onChange:function(e,t){return h(t.key)},id:"exportTypeDropdown"}),o.createElement("br",null),o.createElement(d.a,{value:R,onChange:C,hidden:1===r,showAutoDetect:!1}),o.createElement(a.a,{value:k,onChange:j,showLengthError:!1}),o.createElement("br",null),o.createElement(i.a,{value:S,onChange:T,showAutoDetect:!1}),o.createElement("br",null),o.createElement(u.a,{styles:{root:{display:"inline-block"}},content:t.state.initialized?"":"Excel API is not initialized"},o.createElement(s.a,{onClick:F,disabled:!t.state.initialized,text:"Export to CSV"})),o.createElement("br",null),o.createElement(m.a,{onClick:t.abort,progress:t.state.progress}),1==r?o.createElement(f.a,{value:U,readOnly:!0,label:"Export result",className:v.monospace,multiline:!0,rows:15,spellCheck:!1,wrap:"off"}):null,o.createElement(y.a,{parserOutput:t.state.parserOutput}),o.createElement(b.a,null)))}}}]);
//# sourceMappingURL=export.7fceee3734ff155c4fc3.js.map