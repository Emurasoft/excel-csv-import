(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{452:function(t,e,n){(function(n){var o,r,i;r=[],void 0===(i="function"==typeof(o=function(){"use strict";function e(t,e,n){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){a(o.response,e,n)},o.onerror=function(){console.error("could not download file")},o.send()}function o(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function r(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,a=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype?function(t,n,a){var c=i.URL||i.webkitURL,u=document.createElement("a");n=n||t.name||"download",u.download=n,u.rel="noopener","string"==typeof t?(u.href=t,u.origin===location.origin?r(u):o(u.href)?e(t,n,a):r(u,u.target="_blank")):(u.href=c.createObjectURL(t),setTimeout((function(){c.revokeObjectURL(u.href)}),4e4),setTimeout((function(){r(u)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,n,i){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,i),n);else if(o(t))e(t,n,i);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout((function(){r(a)}))}}:function(t,n,o,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,o);var a="application/octet-stream"===t.type,c=/constructor/i.test(i.HTMLElement)||i.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||a&&c)&&"object"==typeof FileReader){var s=new FileReader;s.onloadend=function(){var t=s.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=t:location=t,r=null},s.readAsDataURL(t)}else{var l=i.URL||i.webkitURL,p=l.createObjectURL(t);r?r.location=p:location.href=p,r=null,setTimeout((function(){l.revokeObjectURL(p)}),4e4)}});i.saveAs=a.saveAs=a,t.exports=a})?o.apply(e,r):o)||(t.exports=i)}).call(this,n(118))},465:function(t,e,n){"use strict";n.r(e),n.d(e,"ExportType",(function(){return o})),n.d(e,"ExportComponent",(function(){return _}));var o,r=n(1),i=n(386),a=n(433),c=n(434),u=n(476),s=n(472),l=n(467),p=n(470),f=n(474),d=n(480),b=n(65),h=n(452),y=n(439),m=n(435),v=n(81),w=n(436),x=n(437),g=n(404),O=n(438),E=n(390);function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){S(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R(t,e,n,o,r,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(o,r)}function C(t){return function(){var e=this,n=arguments;return new Promise((function(o,r){var i=t.apply(e,n);function a(t){R(i,o,r,a,c,"next",t)}function c(t){R(i,o,r,a,c,"throw",t)}a(void 0)}))}}function P(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function L(t,e){return!e||"object"!==T(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function M(t,e){return(M=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}!function(t){t[t.file=0]="file",t[t.text=1]="text"}(o||(o={}));var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(j,t);var e,n,i,g,T=(e=j,function(){var t,n=D(e);if(A()){var o=D(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return L(this,t)});function j(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,j),(e=T.call(this,t,"export",{exportType:o.text,delimiter:",",newline:b.b.CRLF,encoding:"UTF-8",outputText:{show:!1,text:""}},["exportType","delimiter","newline","encoding"])).buttonOnClick=C(regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=function(t,e){return e.exportType===o.text?e.outputText.show?{show:!t.outputText.show,text:t.outputText.text}:{show:t.outputText.show,text:t.outputText.text}:{show:!1,text:""}},r=k({},e.state),e.setState((function(t){return{outputText:n(t,r)}})),t.next=5,e.props.store.csvStringAndName(e.state);case 5:if(null!==(i=t.sent)){t.next=8;break}return t.abrupt("return");case 8:e.saveOrOutput(i,r);case 9:case"end":return t.stop()}}),t)}))),e}return n=j,(i=[{key:"render",value:function(){var t=this,e=[{key:o.text,text:"Textbox"}];this.props.store.state.platform===Office.PlatformType.OfficeOnline&&e.push({key:o.file,text:"File"});var n=r.createElement(u.a,{label:"Export result",className:v.monospace,readOnly:!0,multiline:!0,rows:15,spellCheck:!1,wrap:"off",value:this.state.outputText.text}),i=r.createElement(s.a,{style:{color:"red"},variant:"medium"},"Large file export is not supported");return r.createElement(r.Fragment,null,r.createElement("div",{className:v.pageMargin},r.createElement(O.a,{text:"Export CSV",helpLink:"https://github.com/Emurasoft/excel-csv-import-help/blob/master/en.md#export-csv",mac:this.props.store.state.platform===Office.PlatformType.Mac}),r.createElement(l.a,{label:"Export type",options:e,responsiveMode:E.ResponsiveMode.large,selectedKey:this.state.exportType,onChange:function(e,n){return t.setState({exportType:n.key})},id:"exportTypeDropdown"}),r.createElement("br",null),r.createElement(y.a,{value:this.state.encoding,onChange:function(e){return t.setState({encoding:e})},hidden:this.state.exportType===o.text,showAutoDetect:!1}),r.createElement(a.a,{value:this.state.delimiter,onChange:function(e){return t.setState({delimiter:e})},showLengthError:!1}),r.createElement("br",null),r.createElement(c.a,{value:this.state.newline,onChange:function(e){return t.setState({newline:e})},showAutoDetect:!1}),r.createElement("br",null),r.createElement(p.a,{styles:{root:{display:"inline-block"}},content:this.buttonTooltipContent()},r.createElement(f.a,{onClick:this.buttonOnClick,disabled:""!==this.buttonTooltipContent(),text:"Export to CSV"})),r.createElement("br",null),this.props.store.state.largeFile?i:null,r.createElement(m.a,{onClick:this.props.store.abort,progress:this.props.store.state.progress}),r.createElement(d.a,{inlineLabel:!0,label:"Save options",defaultChecked:this.initialSaveStatus(),onChange:function(e,n){return t.setSaveStatus(n)}}),this.state.outputText.show?n:null,r.createElement(x.a,{parserOutput:this.props.store.state.parserOutput}),r.createElement(w.a,null)))}},{key:"saveOrOutput",value:function(t,e){switch(e.exportType){case o.file:var n={type:"text/csv;charset="+e.encoding},r=new Blob([t.string],n);return void h.saveAs(r,t.name+".csv");case o.text:return void this.setState((function(e){return{outputText:{show:!e.outputText.show,text:t.string}}}))}}},{key:"buttonTooltipContent",value:function(){return this.props.store.state.initialized?"":"Excel API is not initialized"}}])&&P(n.prototype,i),g&&P(n,g),j}(g.a);e.default=Object(i.a)(_)}}]);
//# sourceMappingURL=export.54cf23726cf020be2aa2.js.map