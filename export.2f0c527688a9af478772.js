(self.webpackChunkexcel_csv_import=self.webpackChunkexcel_csv_import||[]).push([[157],{8036:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>O}),n(82526),n(41817),n(32165),n(91038),n(66992),n(47042),n(68309),n(41539),n(88674),n(39714),n(78783),n(33948),n(35666);var r=n(67294),o=n(14661),a=n(9626),i=n(71974),l=n(68945),c=n(12113),u=n(25530),s=n(26497),f=n(93162),p=n(77378),d=n(98836),m=n(5343),v=n(51687),b=n(64803),y=n(55877),w=n(92620),h=n(84844),g=n(31005);function E(e,t,n,r,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var A=(0,w.a)("export");function O(){var e=(0,h.v9)((function(e){return e.initialized})),t=(0,h.v9)((function(e){return e.platform})),n=(0,h.v9)((function(e){return e.progress})),w=(0,h.v9)((function(e){return e.output})),k=(0,h.I0)(),O=x(A("exportType",1),2),T=O[0],L=O[1],j=x(A("delimiter",","),2),R=j[0],S=j[1],C=x(A("newline","\r\n"),2),U=C[0],M=C[1],D=x(A("encoding","UTF-8"),2),_=D[0],B=D[1],H=x((0,r.useState)(""),2),I=H[0],P=H[1],F=[{key:1,text:"Textbox"}];t===Office.PlatformType.OfficeOnline&&F.push({key:0,text:"File"});var G=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(""),t=T,n=_,e.next=5,k((0,g.sD)({delimiter:R,newline:U}));case 5:if(null!==(r=e.sent)){e.next=8;break}return e.abrupt("return");case 8:e.t0=t,e.next=0===e.t0?11:1===e.t0?15:17;break;case 11:return o={type:"text/csv;charset="+n},a=new Blob([r.string],o),f.saveAs(a,r.name+".csv"),e.abrupt("return");case 15:return P(r.string),e.abrupt("return");case 17:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){E(a,r,o,i,l,"next",e)}function l(e){E(a,r,o,i,l,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();return r.createElement(y.T,{text:"Export CSV",helpLink:"https://github.com/Emurasoft/excel-csv-import-help/blob/master/en.md#export-csv",mac:t===Office.PlatformType.Mac},r.createElement(i.L,{label:"Export type",options:F,responsiveMode:l.eD.large,selectedKey:T,onChange:function(e,t){return L(t.key)},id:"exportTypeDropdown"}),r.createElement("br",null),0===T?r.createElement(p.C,{value:_,onChange:B,showAutoDetect:!1}):null,r.createElement(o.N,{value:R,onChange:S,showLengthError:!1}),r.createElement("br",null),r.createElement(a.U,{value:U,onChange:M,showAutoDetect:!1}),r.createElement("br",null),r.createElement(c.G,{styles:{root:{display:"inline-block"}},content:e?"":"Excel API is not initialized"},r.createElement(u.K,{onClick:G,disabled:!e,text:"Export to CSV"})),r.createElement("br",null),r.createElement(d.k,{onClick:function(){return k((0,g.JG)())},progress:n}),1==T?r.createElement(s.n,{value:I,readOnly:!0,label:"Export result",className:m.monospace,rows:15,multiline:!0,spellCheck:!1,wrap:"off"}):null,r.createElement(b.N,{output:w}),r.createElement(v._,null))}},93162:function(e,t,n){var r;void 0===(r=function(){"use strict";function t(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){i(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,i=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype?function(e,n,i){var l=a.URL||a.webkitURL,c=document.createElement("a");n=n||e.name||"download",c.download=n,c.rel="noopener","string"==typeof e?(c.href=e,c.origin===location.origin?o(c):r(c.href)?t(e,n,i):o(c,c.target="_blank")):(c.href=l.createObjectURL(e),setTimeout((function(){l.revokeObjectURL(c.href)}),4e4),setTimeout((function(){o(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,a){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,a),n);else if(r(e))t(e,n,a);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){o(i)}))}}:function(e,n,r,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,r);var i="application/octet-stream"===e.type,l=/constructor/i.test(a.HTMLElement)||a.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||i&&l)&&"object"==typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},u.readAsDataURL(e)}else{var s=a.URL||a.webkitURL,f=s.createObjectURL(e);o?o.location=f:location.href=f,o=null,setTimeout((function(){s.revokeObjectURL(f)}),4e4)}});a.saveAs=i.saveAs=i,e.exports=i}.apply(t,[]))||(e.exports=r)}}]);
//# sourceMappingURL=export.2f0c527688a9af478772.js.map