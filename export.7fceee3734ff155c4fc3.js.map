{"version":3,"sources":["webpack:///./node_modules/file-saver/dist/FileSaver.min.js","webpack:///./components/Export.tsx"],"names":["c","b","d","e","XMLHttpRequest","open","responseType","onload","a","response","onerror","console","error","send","status","dispatchEvent","MouseEvent","document","createEvent","initMouseEvent","window","f","self","global","saveAs","HTMLAnchorElement","prototype","g","h","i","URL","webkitURL","j","createElement","name","download","rel","href","origin","location","target","createObjectURL","setTimeout","revokeObjectURL","navigator","msSaveOrOpenBlob","autoBom","warn","test","type","Blob","title","body","innerText","HTMLElement","safari","userAgent","FileReader","onloadend","result","replace","readAsDataURL","k","l","module","exports","Export","ExportComponent","store","useLocalStorage","exportType","setExportType","delimiter","setDelimiter","newline","setNewline","encoding","setEncoding","outputText","setOutputText","exportTypeOptions","key","text","state","platform","Office","PlatformType","OfficeOnline","push","buttonOnClick","exportTypeCopy","encodingCopy","csvStringAndName","options","blob","string","className","helpLink","mac","Mac","label","responsiveMode","large","selectedKey","onChange","_","option","id","value","hidden","showAutoDetect","showLengthError","styles","root","display","content","initialized","onClick","disabled","abort","progress","readOnly","multiline","rows","spellCheck","wrap","parserOutput"],"mappings":"8EAAA,sBAAwD,EAAO,QAAI,0BAAF,EAA8F,WAAW,aAA4T,SAASA,EAAEC,EAAED,EAAEE,GAAG,IAAIC,EAAE,IAAIC,eAAeD,EAAEE,KAAK,MAAMJ,GAAGE,EAAEG,aAAa,OAAOH,EAAEI,OAAO,WAAWC,EAAEL,EAAEM,SAAST,EAAEE,IAAIC,EAAEO,QAAQ,WAAWC,QAAQC,MAAM,4BAA4BT,EAAEU,OAAO,SAASX,EAAEM,GAAG,IAAIP,EAAE,IAAIG,eAAeH,EAAEI,KAAK,OAAOG,GAAE,GAAI,IAAIP,EAAEY,OAAO,MAAML,IAAI,OAAO,KAAKP,EAAEa,QAAQ,KAAKb,EAAEa,OAAO,SAASX,EAAEK,GAAG,IAAIA,EAAEO,cAAc,IAAIC,WAAW,UAAU,MAAMhB,GAAG,IAAIC,EAAEgB,SAASC,YAAY,eAAejB,EAAEkB,eAAe,SAAQ,GAAG,EAAGC,OAAO,EAAE,EAAE,EAAE,GAAG,IAAG,GAAG,GAAG,GAAG,EAAG,EAAE,MAAMZ,EAAEO,cAAcd,IAAI,IAAIoB,EAAE,iBAAiBD,QAAQA,OAAOA,SAASA,OAAOA,OAAO,iBAAiBE,MAAMA,KAAKA,OAAOA,KAAKA,KAAK,iBAAiBC,GAAQA,EAAOA,SAASA,EAAOA,OAAO,EAAOf,EAAEa,EAAEG,SAAS,iBAAiBJ,QAAQA,SAASC,EAAE,aAAa,aAAaI,kBAAkBC,UAAU,SAASzB,EAAE0B,EAAEC,GAAG,IAAIC,EAAER,EAAES,KAAKT,EAAEU,UAAUC,EAAEf,SAASgB,cAAc,KAAKN,EAAEA,GAAG1B,EAAEiC,MAAM,WAAWF,EAAEG,SAASR,EAAEK,EAAEI,IAAI,WAAW,iBAAiBnC,GAAG+B,EAAEK,KAAKpC,EAAE+B,EAAEM,SAASC,SAASD,OAAOnC,EAAE6B,GAAG9B,EAAE8B,EAAEK,MAAMrC,EAAEC,EAAE0B,EAAEC,GAAGzB,EAAE6B,EAAEA,EAAEQ,OAAO,YAAYR,EAAEK,KAAKR,EAAEY,gBAAgBxC,GAAGyC,YAAW,WAAWb,EAAEc,gBAAgBX,EAAEK,QAAO,KAAKK,YAAW,WAAWvC,EAAE6B,KAAI,KAAK,qBAAqBY,UAAU,SAASvB,EAAEM,EAAEC,GAAG,GAAGD,EAAEA,GAAGN,EAAEa,MAAM,WAAW,iBAAiBb,EAAEuB,UAAUC,iBAA5/C,SAAWrC,EAAEP,GAAG,YAAM,IAAoBA,EAAEA,EAAE,CAAC6C,SAAQ,GAAI,iBAAiB7C,IAAIU,QAAQoC,KAAK,sDAAsD9C,EAAE,CAAC6C,SAAS7C,IAAIA,EAAE6C,SAAS,6EAA6EE,KAAKxC,EAAEyC,MAAM,IAAIC,KAAK,CAAC,SAAS1C,GAAG,CAACyC,KAAKzC,EAAEyC,OAAOzC,EAAguCP,CAAEoB,EAAEO,GAAGD,QAAQ,GAAGzB,EAAEmB,GAAGrB,EAAEqB,EAAEM,EAAEC,OAAO,CAAC,IAAIC,EAAEZ,SAASgB,cAAc,KAAKJ,EAAEQ,KAAKhB,EAAEQ,EAAEW,OAAO,SAASE,YAAW,WAAWvC,EAAE0B,QAAO,SAASrB,EAAEP,EAAEC,EAAEC,GAAG,IAAGA,EAAEA,GAAGE,KAAK,GAAG,aAAcF,EAAEc,SAASkC,MAAMhD,EAAEc,SAASmC,KAAKC,UAAU,kBAAkB,iBAAiB7C,EAAE,OAAOR,EAAEQ,EAAEP,EAAEC,GAAG,IAAIyB,EAAE,6BAA6BnB,EAAEyC,KAAKrB,EAAE,eAAeoB,KAAK3B,EAAEiC,cAAcjC,EAAEkC,OAAO1B,EAAE,eAAemB,KAAKJ,UAAUY,WAAW,IAAI3B,GAAGF,GAAGC,IAAI,iBAAiB6B,WAAW,CAAC,IAAIzB,EAAE,IAAIyB,WAAWzB,EAAE0B,UAAU,WAAW,IAAIlD,EAAEwB,EAAE2B,OAAOnD,EAAEqB,EAAErB,EAAEA,EAAEoD,QAAQ,eAAe,yBAAyBzD,EAAEA,EAAEoC,SAASF,KAAK7B,EAAE+B,SAAS/B,EAAEL,EAAE,MAAM6B,EAAE6B,cAAcrD,OAAO,CAAC,IAAIsD,EAAEzC,EAAES,KAAKT,EAAEU,UAAUgC,EAAED,EAAErB,gBAAgBjC,GAAGL,EAAEA,EAAEoC,SAASwB,EAAExB,SAASF,KAAK0B,EAAE5D,EAAE,KAAKuC,YAAW,WAAWoB,EAAEnB,gBAAgBoB,KAAI,QAAQ1C,EAAEG,OAAOhB,EAAEgB,OAAOhB,EAA+BwD,EAAOC,QAAQzD,IAA77E,iC,g8CCyBrD,SAAU0D,IACvB,OAAO,gBAACC,EAAe,CAACC,MAAO,qBAAW,OAG3C,IAAMC,EAAkB,YAA0B,UAE5C,SAAUF,EAAV,GAAiD,IAAtBC,EAAsB,EAAtBA,MAAsB,IAClBC,EAAgB,aAAY,GADV,GAC/CC,EAD+C,KACnCC,EADmC,SAEpBF,EAAgB,YAAa,KAFT,GAE/CG,EAF+C,KAEpCC,EAFoC,SAGxBJ,EAAgB,UAAS,QAHD,GAG/CK,EAH+C,KAGtCC,EAHsC,SAItBN,EAAgB,WAAY,SAJN,GAI/CO,EAJ+C,KAIrCC,EAJqC,SAKlB,mBAAS,IALS,GAK/CC,EAL+C,KAKnCC,EALmC,KAOhDC,EAAuC,CAAC,CAC7CC,IAAK,EACLC,KAAM,YAKHd,EAAMe,MAAMC,WAAaC,OAAOC,aAAaC,cAChDP,EAAkBQ,KAAK,CACtBP,IAAK,EACLC,KAAM,SAIR,IAGMO,EAAa,e,EAAA,G,EAAA,yBAAG,kHACrBV,EAAc,IAERW,EAAiBpB,EACjBqB,EAAef,EAJA,SAKUR,EAAMwB,iBAAiB,CAACpB,YAAWE,YAL7C,UAMI,QADnBkB,EALe,8DAUbF,EAVa,OAWrB,IAXqB,QAiBrB,IAjBqB,gCAYdG,EAAU,CAAC5C,KAAM,oBAAsB0C,GACvCG,EAAO,IAAI5C,KAAK,CAAC0C,EAAiBG,QAASF,GACjD,SAAiBC,EAAMF,EAAiB1D,KAAO,QAd3B,kCAkBpB6C,EAAca,EAAiBG,QAlBX,8D,+KAAH,qDAwBnB,OACC,gCACC,uBAAKC,UAAW,cAEf,gBAAC,IAAQ,CACRd,KAAM,aACNe,SAhCD,kFAiCCC,IAAK9B,EAAMe,MAAMC,WAAaC,OAAOC,aAAaa,MAGnD,gBAAC,IAAQ,CACRC,MAAO,cACPP,QAASb,EACTqB,eAAgB,IAAeC,MAC/BC,YAAajC,EACbkC,SAAU,SAACC,EAAGC,GAAJ,OAAenC,EAAcmC,EAAOzB,MAC9C0B,GAAI,uBAEL,2BACA,gBAAC,IAAgB,CAChBC,MAAOhC,EACP4B,SAAU3B,EACVgC,OAAuB,IAAfvC,EACRwC,gBAAgB,IAEjB,gBAAC,IAAc,CACdF,MAAOpC,EACPgC,SAAU/B,EACVsC,iBAAiB,IAElB,2BACA,gBAAC,IAAe,CACfH,MAAOlC,EACP8B,SAAU7B,EACVmC,gBAAgB,IAEjB,2BACA,gBAAC,IAAW,CACXE,OAAQ,CAACC,KAAM,CAACC,QAAS,iBACzBC,QACC/C,EAAMe,MAAMiC,YACT,GACA,gCAGJ,gBAAC,IAAa,CACbC,QAAS5B,EACT6B,UAAWlD,EAAMe,MAAMiC,YACvBlC,KAAM,mBAGR,2BACA,gBAAC,IAAW,CACXmC,QAASjD,EAAMmD,MACfC,SAAUpD,EAAMe,MAAMqC,WAGR,GAAdlD,EACG,gBAAC,IAAS,CACXsC,MAAO9B,EAAY2C,UAAQ,EAC3BrB,MAAO,gBACPJ,UAAW,YACX0B,WAAS,EAACC,KAAM,GAChBC,YAAY,EACZC,KAAK,QAEJ,KAEJ,gBAAC,IAAe,CAACC,aAAc1D,EAAMe,MAAM2C,eAC3C,gBAAC,IAAS","file":"export.7fceee3734ff155c4fc3.js","sourcesContent":["(function(a,b){if(\"function\"==typeof define&&define.amd)define([],b);else if(\"undefined\"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){\"use strict\";function b(a,b){return\"undefined\"==typeof b?b={autoBom:!1}:\"object\"!=typeof b&&(console.warn(\"Deprecated: Expected third argument to be a object\"),b={autoBom:!b}),b.autoBom&&/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(a.type)?new Blob([\"\\uFEFF\",a],{type:a.type}):a}function c(b,c,d){var e=new XMLHttpRequest;e.open(\"GET\",b),e.responseType=\"blob\",e.onload=function(){a(e.response,c,d)},e.onerror=function(){console.error(\"could not download file\")},e.send()}function d(a){var b=new XMLHttpRequest;b.open(\"HEAD\",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent(\"click\"))}catch(c){var b=document.createEvent(\"MouseEvents\");b.initMouseEvent(\"click\",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f=\"object\"==typeof window&&window.window===window?window:\"object\"==typeof self&&self.self===self?self:\"object\"==typeof global&&global.global===global?global:void 0,a=f.saveAs||(\"object\"!=typeof window||window!==f?function(){}:\"download\"in HTMLAnchorElement.prototype?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement(\"a\");g=g||b.name||\"download\",j.download=g,j.rel=\"noopener\",\"string\"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target=\"_blank\")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:\"msSaveOrOpenBlob\"in navigator?function(f,g,h){if(g=g||f.name||\"download\",\"string\"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement(\"a\");i.href=f,i.target=\"_blank\",setTimeout(function(){e(i)})}}:function(a,b,d,e){if(e=e||open(\"\",\"_blank\"),e&&(e.document.title=e.document.body.innerText=\"downloading...\"),\"string\"==typeof a)return c(a,b,d);var g=\"application/octet-stream\"===a.type,h=/constructor/i.test(f.HTMLElement)||f.safari,i=/CriOS\\/[\\d]+/.test(navigator.userAgent);if((i||g&&h)&&\"object\"==typeof FileReader){var j=new FileReader;j.onloadend=function(){var a=j.result;a=i?a:a.replace(/^data:[^;]*;/,\"data:attachment/file;\"),e?e.location.href=a:location=a,e=null},j.readAsDataURL(a)}else{var k=f.URL||f.webkitURL,l=k.createObjectURL(a);e?e.location=l:location.href=l,e=null,setTimeout(function(){k.revokeObjectURL(l)},4E4)}});f.saveAs=a.saveAs=a,\"undefined\"!=typeof module&&(module.exports=a)});\n\n//# sourceMappingURL=FileSaver.min.js.map","import {Context, Store} from '../Store';\nimport * as React from 'react';\nimport {DelimiterInput} from './DelimiterInput';\nimport {NewlineDropdown} from './NewlineDropdown';\nimport {\n\tDropdown,\n\tIDropdownOption,\n\tPrimaryButton,\n\tTextField,\n\tTooltipHost,\n\tResponsiveMode,\n} from '@fluentui/react';\nimport {NewlineSequence} from '../Parser';\nimport * as FileSaver from 'file-saver';\nimport {EncodingDropdown} from './EncodingDropdown';\nimport {ProgressBar} from './ProgressBar';\nimport * as style from './style.css';\nimport {BottomBar} from './BottomBar';\nimport {ParserOutputBox} from './ParserOutputBox';\nimport {TitleBar} from './TitleBar';\nimport {useContext, useState} from 'react';\nimport {namespacedUseLocalStorage} from '../useLocalStorage';\n\nexport const enum ExportType {file, text}\n\nexport default function Export(): React.ReactElement {\n\treturn <ExportComponent store={useContext(Context)} />;\n}\n\nconst useLocalStorage = namespacedUseLocalStorage('export');\n\nexport function ExportComponent({store}: {store: Store}): React.ReactElement {\n\tconst [exportType, setExportType] = useLocalStorage('exportType', ExportType.text);\n\tconst [delimiter, setDelimiter] = useLocalStorage('delimiter', '\\u002c');\n\tconst [newline, setNewline] = useLocalStorage('newline', NewlineSequence.CRLF);\n\tconst [encoding, setEncoding] = useLocalStorage('encoding', 'UTF-8');\n\tconst [outputText, setOutputText] = useState('');\n\n\tconst exportTypeOptions: IDropdownOption[] = [{\n\t\tkey: ExportType.text,\n\t\ttext: 'Textbox',\n\t}];\n\t// Export file feature only works on Excel Online\n\t// https://github.com/Emurasoft/excel-csv-import/issues/39\n\t// eslint-disable-next-line no-undef\n\tif (store.state.platform === Office.PlatformType.OfficeOnline) {\n\t\texportTypeOptions.push({\n\t\t\tkey: ExportType.file,\n\t\t\ttext: 'File',\n\t\t});\n\t}\n\n\tconst helpLink\n\t\t= 'https://github.com/Emurasoft/excel-csv-import-help/blob/master/en.md#export-csv';\n\n\tconst buttonOnClick = async () => {\n\t\tsetOutputText('');\n\n\t\tconst exportTypeCopy = exportType; // Copy current options before async task\n\t\tconst encodingCopy = encoding;\n\t\tconst csvStringAndName = await store.csvStringAndName({delimiter, newline});\n\t\tif (csvStringAndName === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (exportTypeCopy) {\n\t\tcase ExportType.file: {\n\t\t\tconst options = {type: 'text/csv;charset=' + encodingCopy};\n\t\t\tconst blob = new Blob([csvStringAndName.string], options);\n\t\t\tFileSaver.saveAs(blob, csvStringAndName.name + '.csv');\n\t\t\treturn;\n\t\t}\n\t\tcase ExportType.text: {\n\t\t\tsetOutputText(csvStringAndName.string)\n\t\t\treturn;\n\t\t}\n\t\t}\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<div className={style.pageMargin}>\n\t\t\t\t{/* eslint-disable no-undef */}\n\t\t\t\t<TitleBar\n\t\t\t\t\ttext={'Export CSV'}\n\t\t\t\t\thelpLink={helpLink}\n\t\t\t\t\tmac={store.state.platform === Office.PlatformType.Mac}\n\t\t\t\t/>\n\t\t\t\t{/* eslint-enable no-undef */}\n\t\t\t\t<Dropdown\n\t\t\t\t\tlabel={'Export type'}\n\t\t\t\t\toptions={exportTypeOptions}\n\t\t\t\t\tresponsiveMode={ResponsiveMode.large}\n\t\t\t\t\tselectedKey={exportType}\n\t\t\t\t\tonChange={(_, option) => setExportType(option.key as ExportType)}\n\t\t\t\t\tid={'exportTypeDropdown'}\n\t\t\t\t/>\n\t\t\t\t<br />\n\t\t\t\t<EncodingDropdown\n\t\t\t\t\tvalue={encoding}\n\t\t\t\t\tonChange={setEncoding}\n\t\t\t\t\thidden={exportType === ExportType.text /* TODO this parameter is unnecessary*/}\n\t\t\t\t\tshowAutoDetect={false}\n\t\t\t\t/>\n\t\t\t\t<DelimiterInput\n\t\t\t\t\tvalue={delimiter}\n\t\t\t\t\tonChange={setDelimiter}\n\t\t\t\t\tshowLengthError={false}\n\t\t\t\t/>\n\t\t\t\t<br />\n\t\t\t\t<NewlineDropdown\n\t\t\t\t\tvalue={newline}\n\t\t\t\t\tonChange={setNewline}\n\t\t\t\t\tshowAutoDetect={false}\n\t\t\t\t/>\n\t\t\t\t<br />\n\t\t\t\t<TooltipHost\n\t\t\t\t\tstyles={{root: {display: 'inline-block'}}}\n\t\t\t\t\tcontent={\n\t\t\t\t\t\tstore.state.initialized\n\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t: 'Excel API is not initialized'\n\t\t\t\t\t}\n\t\t\t\t>\n\t\t\t\t\t<PrimaryButton\n\t\t\t\t\t\tonClick={buttonOnClick}\n\t\t\t\t\t\tdisabled={!store.state.initialized}\n\t\t\t\t\t\ttext={'Export to CSV'}\n\t\t\t\t\t/>\n\t\t\t\t</TooltipHost>\n\t\t\t\t<br />\n\t\t\t\t<ProgressBar\n\t\t\t\t\tonClick={store.abort}\n\t\t\t\t\tprogress={store.state.progress}\n\t\t\t\t/>\n\t\t\t\t{\n\t\t\t\t\texportType == ExportType.text\n\t\t\t\t\t\t? <TextField\n\t\t\t\t\t\t\tvalue={outputText} readOnly\n\t\t\t\t\t\t\tlabel={'Export result'}\n\t\t\t\t\t\t\tclassName={style.monospace}\n\t\t\t\t\t\t\tmultiline rows={15}\n\t\t\t\t\t\t\tspellCheck={false}\n\t\t\t\t\t\t\twrap='off'\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t: null\n\t\t\t\t}\n\t\t\t\t<ParserOutputBox parserOutput={store.state.parserOutput} />\n\t\t\t\t<BottomBar />\n\t\t\t</div>\n\t\t</>\n\t);\n}"],"sourceRoot":""}