{"version":3,"sources":["webpack:///./node_modules/file-saver/dist/FileSaver.min.js","webpack:///./components/Export.tsx"],"names":["c","b","d","e","XMLHttpRequest","open","responseType","onload","a","response","onerror","console","error","send","status","dispatchEvent","MouseEvent","document","createEvent","initMouseEvent","window","f","self","global","saveAs","HTMLAnchorElement","prototype","g","h","i","URL","webkitURL","j","createElement","name","download","rel","href","origin","location","target","createObjectURL","setTimeout","revokeObjectURL","navigator","msSaveOrOpenBlob","autoBom","warn","test","type","Blob","title","body","innerText","HTMLElement","safari","userAgent","FileReader","onloadend","result","replace","readAsDataURL","k","l","module","exports","ExportComponent","props","exportType","delimiter","newline","encoding","outputText","show","text","buttonOnClick","newOutputText","state","exportOptions","setState","store","csvStringAndName","saveOrOutput","exportTypeOptions","key","this","platform","Office","PlatformType","OfficeOnline","push","outputTextField","label","className","readOnly","multiline","rows","spellCheck","wrap","value","largeFileWarning","style","color","variant","helpLink","mac","Mac","options","responsiveMode","large","selectedKey","onChange","_","option","id","hidden","showAutoDetect","showLengthError","styles","root","display","content","buttonTooltipContent","onClick","disabled","largeFile","abort","progress","inlineLabel","defaultChecked","initialSaveStatus","checked","setSaveStatus","parserOutput","blob","string","initialized"],"mappings":"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","file":"export.e8af87209f2ad396cb5b.js","sourcesContent":["(function(a,b){if(\"function\"==typeof define&&define.amd)define([],b);else if(\"undefined\"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){\"use strict\";function b(a,b){return\"undefined\"==typeof b?b={autoBom:!1}:\"object\"!=typeof b&&(console.warn(\"Deprecated: Expected third argument to be a object\"),b={autoBom:!b}),b.autoBom&&/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(a.type)?new Blob([\"\\uFEFF\",a],{type:a.type}):a}function c(b,c,d){var e=new XMLHttpRequest;e.open(\"GET\",b),e.responseType=\"blob\",e.onload=function(){a(e.response,c,d)},e.onerror=function(){console.error(\"could not download file\")},e.send()}function d(a){var b=new XMLHttpRequest;b.open(\"HEAD\",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent(\"click\"))}catch(c){var b=document.createEvent(\"MouseEvents\");b.initMouseEvent(\"click\",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f=\"object\"==typeof window&&window.window===window?window:\"object\"==typeof self&&self.self===self?self:\"object\"==typeof global&&global.global===global?global:void 0,a=f.saveAs||(\"object\"!=typeof window||window!==f?function(){}:\"download\"in HTMLAnchorElement.prototype?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement(\"a\");g=g||b.name||\"download\",j.download=g,j.rel=\"noopener\",\"string\"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target=\"_blank\")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:\"msSaveOrOpenBlob\"in navigator?function(f,g,h){if(g=g||f.name||\"download\",\"string\"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement(\"a\");i.href=f,i.target=\"_blank\",setTimeout(function(){e(i)})}}:function(a,b,d,e){if(e=e||open(\"\",\"_blank\"),e&&(e.document.title=e.document.body.innerText=\"downloading...\"),\"string\"==typeof a)return c(a,b,d);var g=\"application/octet-stream\"===a.type,h=/constructor/i.test(f.HTMLElement)||f.safari,i=/CriOS\\/[\\d]+/.test(navigator.userAgent);if((i||g&&h)&&\"object\"==typeof FileReader){var j=new FileReader;j.onloadend=function(){var a=j.result;a=i?a:a.replace(/^data:[^;]*;/,\"data:attachment/file;\"),e?e.location.href=a:location=a,e=null},j.readAsDataURL(a)}else{var k=f.URL||f.webkitURL,l=k.createObjectURL(a);e?e.location=l:location.href=l,e=null,setTimeout(function(){k.revokeObjectURL(l)},4E4)}});f.saveAs=a.saveAs=a,\"undefined\"!=typeof module&&(module.exports=a)});\n\n//# sourceMappingURL=FileSaver.min.js.map","import {Store} from '../Store';\nimport * as React from 'react';\nimport {connect} from '../connect';\nimport {DelimiterInput} from './DelimiterInput';\nimport {NewlineDropdown} from './NewlineDropdown';\nimport {\n\tDropdown,\n\tIDropdownOption,\n\tPrimaryButton,\n\tText,\n\tTextField,\n\tToggle,\n\tTooltipHost,\n\tResponsiveMode,\n} from '@fluentui/react';\nimport {CsvStringAndName, ExportOptions, NewlineSequence} from '../Parser';\nimport * as FileSaver from 'file-saver';\nimport {EncodingDropdown} from './EncodingDropdown';\nimport {ProgressBar} from './ProgressBar';\nimport * as style from './style.css';\nimport {BottomBar} from './BottomBar';\nimport {ParserOutputBox} from './ParserOutputBox';\nimport {StoredComponent} from './StoredComponent';\nimport {MemoryHistory} from 'history';\nimport {TitleBar} from './TitleBar';\n\nexport interface OutputText {\n\t// If show is false, do not show text.\n\tshow: boolean;\n\ttext: string;\n}\n\ninterface Props {\n\tstore: Store;\n\thistory: MemoryHistory;\n}\n\nexport const enum ExportType {file, text}\n\ninterface State extends ExportOptions {\n\texportType: ExportType;\n\toutputText: OutputText;\n\tencoding: string;\n}\n\nexport class ExportComponent extends StoredComponent<Props, State> {\n\tpublic constructor(props: Props) {\n\t\tsuper(props, 'export', {\n\t\t\texportType: ExportType.text,\n\t\t\tdelimiter: '\\u002c',\n\t\t\tnewline: NewlineSequence.CRLF,\n\t\t\tencoding: 'UTF-8',\n\t\t\toutputText: {\n\t\t\t\tshow: false,\n\t\t\t\ttext: '',\n\t\t\t},\n\t\t}, ['exportType', 'delimiter', 'newline', 'encoding']);\n\t}\n\n\tpublic render(): React.ReactNode {\n\t\tconst exportTypeOptions: IDropdownOption[] = [{\n\t\t\tkey: ExportType.text,\n\t\t\ttext: 'Textbox',\n\t\t}];\n\t\t// Export file feature only works on Excel Online\n\t\t// https://github.com/Emurasoft/excel-csv-import/issues/39\n\t\t// eslint-disable-next-line no-undef\n\t\tif (this.props.store.state.platform === Office.PlatformType.OfficeOnline) {\n\t\t\texportTypeOptions.push({\n\t\t\t\tkey: ExportType.file,\n\t\t\t\ttext: 'File',\n\t\t\t});\n\t\t}\n\n\t\tconst outputTextField = (\n\t\t\t<TextField\n\t\t\t\tlabel={'Export result'}\n\t\t\t\tclassName={style.monospace}\n\t\t\t\treadOnly={true}\n\t\t\t\tmultiline rows={15}\n\t\t\t\tspellCheck={false}\n\t\t\t\twrap='off'\n\t\t\t\tvalue={this.state.outputText.text}\n\t\t\t/>\n\t\t);\n\n\t\tconst largeFileWarning = (\n\t\t\t<Text style={{color: 'red'}} variant='medium'>\n\t\t\t\t{'Large file export is not supported'}\n\t\t\t</Text>\n\t\t);\n\n\t\tconst helpLink\n            = 'https://github.com/Emurasoft/excel-csv-import-help/blob/master/en.md#export-csv';\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div className={style.pageMargin}>\n\t\t\t\t\t{/* eslint-disable no-undef */}\n\t\t\t\t\t<TitleBar\n\t\t\t\t\t\ttext={'Export CSV'}\n\t\t\t\t\t\thelpLink={helpLink}\n\t\t\t\t\t\tmac={this.props.store.state.platform === Office.PlatformType.Mac}\n\t\t\t\t\t/>\n\t\t\t\t\t{/* eslint-enable no-undef */}\n\t\t\t\t\t<Dropdown\n\t\t\t\t\t\tlabel={'Export type'}\n\t\t\t\t\t\toptions={exportTypeOptions}\n\t\t\t\t\t\tresponsiveMode={ResponsiveMode.large}\n\t\t\t\t\t\tselectedKey={this.state.exportType}\n\t\t\t\t\t\tonChange={\n\t\t\t\t\t\t\t(_, option) => this.setState({exportType: option.key as ExportType})\n\t\t\t\t\t\t}\n\t\t\t\t\t\tid={'exportTypeDropdown'}\n\t\t\t\t\t/>\n\t\t\t\t\t<br />\n\t\t\t\t\t<EncodingDropdown\n\t\t\t\t\t\tvalue={this.state.encoding}\n\t\t\t\t\t\tonChange={(encoding) => this.setState({encoding})}\n\t\t\t\t\t\thidden={this.state.exportType === ExportType.text}\n\t\t\t\t\t\tshowAutoDetect={false}\n\t\t\t\t\t/>\n\t\t\t\t\t<DelimiterInput\n\t\t\t\t\t\tvalue={this.state.delimiter}\n\t\t\t\t\t\tonChange={(delimiter) => this.setState({delimiter})}\n\t\t\t\t\t\tshowLengthError={false}\n\t\t\t\t\t/>\n\t\t\t\t\t<br />\n\t\t\t\t\t<NewlineDropdown\n\t\t\t\t\t\tvalue={this.state.newline}\n\t\t\t\t\t\tonChange={(newline) => this.setState({newline})}\n\t\t\t\t\t\tshowAutoDetect={false}\n\t\t\t\t\t/>\n\t\t\t\t\t<br />\n\t\t\t\t\t<TooltipHost\n\t\t\t\t\t\tstyles={{root: {display: 'inline-block'}}}\n\t\t\t\t\t\tcontent={this.buttonTooltipContent()}\n\t\t\t\t\t>\n\t\t\t\t\t\t<PrimaryButton\n\t\t\t\t\t\t\tonClick={this.buttonOnClick}\n\t\t\t\t\t\t\tdisabled={this.buttonTooltipContent() !== ''}\n\t\t\t\t\t\t\ttext={'Export to CSV'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</TooltipHost>\n\t\t\t\t\t<br />\n\t\t\t\t\t{this.props.store.state.largeFile ? largeFileWarning : null}\n\t\t\t\t\t<ProgressBar\n\t\t\t\t\t\tonClick={this.props.store.abort}\n\t\t\t\t\t\tprogress={this.props.store.state.progress}\n\t\t\t\t\t/>\n\t\t\t\t\t<Toggle\n\t\t\t\t\t\tinlineLabel label={'Save options'}\n\t\t\t\t\t\tdefaultChecked={this.initialSaveStatus()}\n\t\t\t\t\t\tonChange={(_, checked) => this.setSaveStatus(checked)}\n\t\t\t\t\t/>\n\t\t\t\t\t{this.state.outputText.show ? outputTextField : null}\n\t\t\t\t\t<ParserOutputBox parserOutput={this.props.store.state.parserOutput} />\n\t\t\t\t\t<BottomBar />\n\t\t\t\t</div>\n\t\t\t</>\n\t\t);\n\t}\n\n\tprivate buttonOnClick = async () => {\n\t\tfunction newOutputText(state, exportOptions): OutputText {\n\t\t\t// If exportType is text:\n\t\t\t//      If last outputText.show was true, flip twice otherwise change once later\n\t\t\t// If exportType is a file, show is set to false once.\n\t\t\tif (exportOptions.exportType === ExportType.text) {\n\t\t\t\tif (exportOptions.outputText.show) {\n\t\t\t\t\treturn {show: !state.outputText.show, text: state.outputText.text};\n\t\t\t\t} else {\n\t\t\t\t\treturn {show: state.outputText.show, text: state.outputText.text};\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn {show: false, text: ''};\n\t\t\t}\n\t\t}\n\n\t\t// Copy values before async operation\n\t\tconst exportOptions = {...this.state};\n\n\t\tthis.setState(state => ({outputText: newOutputText(state, exportOptions)}));\n\n\t\tconst csvStringAndName = await this.props.store.csvStringAndName(this.state);\n\t\tif (csvStringAndName === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.saveOrOutput(csvStringAndName, exportOptions);\n\t}\n\n\tprivate saveOrOutput(csvStringAndName: CsvStringAndName, exportOptions: State): void {\n\t\tswitch (exportOptions.exportType) {\n\t\tcase ExportType.file: {\n\t\t\tconst options = {type: 'text/csv;charset=' + exportOptions.encoding};\n\t\t\tconst blob = new Blob([csvStringAndName.string], options);\n\t\t\tFileSaver.saveAs(blob, csvStringAndName.name + '.csv');\n\t\t\t// state.outputText.show is already false\n\t\t\treturn;\n\t\t}\n\t\tcase ExportType.text: {\n\t\t\tthis.setState(state => ({\n\t\t\t\toutputText: {show: !state.outputText.show, text: csvStringAndName.string},\n\t\t\t}));\n\t\t\treturn;\n\t\t}\n\t\t}\n\t}\n\n\tprivate buttonTooltipContent(): string {\n\t\tif (!this.props.store.state.initialized) {\n\t\t\treturn 'Excel API is not initialized';\n\t\t} else {\n\t\t\treturn '';\n\t\t}\n\t}\n}\n\nexport default connect(ExportComponent);"],"sourceRoot":""}