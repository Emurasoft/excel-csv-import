"use strict";(self.webpackChunkexcel_csv_import=self.webpackChunkexcel_csv_import||[]).push([[6],{35620:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S}),n(82526),n(41817),n(32165),n(91038),n(66992),n(47042),n(68309),n(41539),n(88674),n(39714),n(78783),n(33948),n(35666);var r=n(67294),l=n(12113),i=n(70066),o=n(25530),u=n(5343),a=n(26497),c=n(71974),p=n(68945),s=[{key:0,text:"File"},{key:1,text:"Text input"}];function m(e){var t,n,l=e.value,i=e.onChange;switch(l.inputType){case 0:n=function(e){return i({inputType:0,file:e,text:""})},t=r.createElement(r.Fragment,null,r.createElement("input",{className:u.fullWidth,type:"file",accept:"text/csv",onChange:function(e){return n(e.target.files[0])},id:"SourceInput-FileInput"}),r.createElement("br",null));break;case 1:t=function(e,t){return r.createElement(a.n,{className:u.monospace,multiline:!0,rows:10,spellCheck:!1,wrap:"off",onChange:function(e,t){return function(e){return i({inputType:1,file:null,text:e})}(t)},value:e,id:"SourceInput-TextInput"})}(l.text)}return r.createElement(r.Fragment,null,r.createElement(c.L,{label:"Import type",options:s,responsiveMode:p.eD.large,selectedKey:l.inputType,onChange:function(e,t){return i({inputType:t.key,file:null,text:""})},id:"SourceInput-Dropdown"}),r.createElement("div",{className:u.smallDivider}),t)}var f=n(14661),v=n(9626),y=n(77378),d=n(98836),h=n(51687),g=n(64803),b=n(55877),E=n(92620),w=n(84844),x=n(31005);function C(e,t,n,r,l,i,o){try{var u=e[i](o),a=u.value}catch(e){return void n(e)}u.done?t(a):Promise.resolve(a).then(r,l)}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,l=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){l=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(l)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var T=(0,E.a)("import");function S(){var e,t,n,u=(0,w.v9)((function(e){return e.initialized})),a=(0,w.v9)((function(e){return e.platform})),c=(0,w.v9)((function(e){return e.progress})),p=(0,w.v9)((function(e){return e.output})),s=(0,w.I0)(),E=k((0,r.useState)({inputType:0,file:null,text:""}),2),I=E[0],S=E[1],A=k(T("delimiter",","),2),D=A[0],j=A[1],N=k(T("newline",""),2),_=N[0],F=N[1],O=k(T("encoding",""),2),P=O[0],z=O[1];return e=0==I.inputType&&null==I.file?"Import source is not selected":1!==D.length?"Delimiter is invalid":u?"":"Excel API is not initialized",r.createElement(b.T,{text:"Import CSV",helpLink:"https://github.com/Emurasoft/excel-csv-import-help/blob/master/en.md",mac:a===Office.PlatformType.Mac},r.createElement(m,{value:I,onChange:S}),r.createElement("br",null),0===I.inputType?r.createElement(y.C,{value:P,onChange:z,showAutoDetect:!0}):null,r.createElement(f.N,{value:D,onChange:j,showLengthError:!0}),r.createElement("br",null),r.createElement(v.U,{value:_,onChange:F,showAutoDetect:!0}),r.createElement("br",null),r.createElement(l.G,{styles:{root:{display:"inline-block"}},content:e,delay:i.j.zero},r.createElement(o.K,{disabled:""!==e,onClick:(t=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s((0,x.Tl)({source:I,newline:_,delimiter:D,encoding:P})));case 1:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,l){var i=t.apply(e,n);function o(e){C(i,r,l,o,u,"next",e)}function u(e){C(i,r,l,o,u,"throw",e)}o(void 0)}))},function(){return n.apply(this,arguments)}),text:"Import CSV"})),r.createElement("br",null),r.createElement(d.k,{onClick:function(){return s((0,x.JG)())},progress:c}),r.createElement(g.N,{output:p}),r.createElement(h._,null))}}}]);
//# sourceMappingURL=import.2f0c527688a9af478772.js.map